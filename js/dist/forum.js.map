{"version":3,"file":"forum.js","mappings":"kCAAAA,EAAOC,QAAUC,OAAOC,WAAW,Y,GCC/BC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaN,QAGrB,IAAID,EAASI,EAAyBE,GAAY,CAGjDL,QAAS,CAAC,GAOX,OAHAQ,EAAoBH,GAAUN,EAAQA,EAAOC,QAASI,GAG/CL,EAAOC,OACf,CCrBAI,EAAoBK,EAAKV,IACxB,IAAIW,EAASX,GAAUA,EAAOY,WAC7B,IAAOZ,EAAiB,QACxB,IAAM,EAEP,OADAK,EAAoBQ,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdN,EAAoBQ,EAAI,CAACZ,EAASc,KACjC,IAAI,IAAIC,KAAOD,EACXV,EAAoBY,EAAEF,EAAYC,KAASX,EAAoBY,EAAEhB,EAASe,IAC5EE,OAAOC,eAAelB,EAASe,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDX,EAAoBY,EAAI,CAACK,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFlB,EAAoBsB,EAAK1B,IACH,oBAAX2B,QAA0BA,OAAOC,aAC1CX,OAAOC,eAAelB,EAAS2B,OAAOC,YAAa,CAAEC,MAAO,WAE7DZ,OAAOC,eAAelB,EAAS,aAAc,CAAE6B,OAAO,GAAO,E,mCCL9D,MAAM,EAA+B5B,OAAO6B,KAAKC,OAAO,a,aCAxD,MAAM,EAA+B9B,OAAO6B,KAAKC,OAAO,iBCAlD,EAA+B9B,OAAO6B,KAAKC,OAAO,yB,aCAxD,MAAM,EAA+B9B,OAAO6B,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+B9B,OAAO6B,KAAKC,OAAO,gC,aCexDC,IAAAA,aAAiBC,IAAI,oBAAoB,YACxCC,EAAAA,EAAAA,QAAOC,IAAAA,UAAuB,eAAe,SAAUC,GACtD,IAXgDC,EAW1CC,EAAOC,KAAKC,MAAMF,KAClBG,EAAOH,EAAKG,OAZ8BJ,EAcjBI,GAZ/BT,IAAAA,QAAYS,MACZT,IAAAA,QAAYS,KAAKC,OAASL,EAAUK,OACpCV,IAAAA,MAAUW,UAAU,8BAClBN,EAAUO,aAAcZ,IAAAA,MAAUW,UAAU,0CASNL,EAAKO,KAAKC,WAAWC,UAE7DX,EAAMH,IACL,qBACAe,IAAAA,UAAiB,CAChBC,UAAW,iDACXC,QAAS,SAACC,GAGT,OAFAA,EAAEC,iBAEK,IAAIC,SAAQ,SAACC,GACnB,IAAIC,EAAa,IAAIC,KACjBC,EAA4BC,EAAAA,KAAAA,YAAkCC,0BAgBlE,OAdAJ,EAAWtB,IAAI,SAAWD,IAAAA,QAAYS,KAAKC,KAAMV,IAAAA,QAAYS,MAC7Dc,EAAWtB,IAAI,SAAWQ,EAAKC,KAAMD,GAErCgB,EAA0BlC,UAAUgC,WAAaA,EAEjDvB,IAAAA,SAAa4B,KAAKH,EAA2B,CAC5ChB,KAAMT,IAAAA,QAAYS,KAClBc,WAAYA,EACZM,eAAgBN,EAChBO,iBAAkB9B,IAAAA,WAAe+B,MAAM,iEACvCC,YAAahC,IAAAA,WAAe+B,MAAM,+DAGnC/B,IAAAA,SAAaiC,OACNX,EAAQtB,IAAAA,SAChB,GACD,GAEAA,IAAAA,WAAe+B,MAAM,kCAAmC,CAAEG,SAAUzB,EAAK0B,iBAE5E,GACD,G","sources":["webpack://@jamesinc/send-dm/external assign \"flarum.extensions['fof-byobu']\"","webpack://@jamesinc/send-dm/webpack/bootstrap","webpack://@jamesinc/send-dm/webpack/runtime/compat get default export","webpack://@jamesinc/send-dm/webpack/runtime/define property getters","webpack://@jamesinc/send-dm/webpack/runtime/hasOwnProperty shorthand","webpack://@jamesinc/send-dm/webpack/runtime/make namespace object","webpack://@jamesinc/send-dm/external root \"flarum.core.compat['forum/app']\"","webpack://@jamesinc/send-dm/external root \"flarum.core.compat['common/extend']\"","webpack://@jamesinc/send-dm/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@jamesinc/send-dm/external root \"flarum.core.compat['common/components/Button']\"","webpack://@jamesinc/send-dm/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@jamesinc/send-dm/./src/forum/index.js"],"sourcesContent":["module.exports = flarum.extensions['fof-byobu'];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Button from 'flarum/common/components/Button';\nimport CommentPost from 'flarum/forum/components/CommentPost';\n\nexport default function canStartPrivateDiscussion(recipient) {\n\treturn (\n\t\tapp.session.user &&\n\t\tapp.session.user.id() !== recipient.id() &&\n\t\tapp.forum.attribute('canStartPrivateDiscussion') &&\n\t\t(!recipient.blocksPd() || app.forum.attribute('canStartPrivateDiscussionWithBlockers'))\n\t);\n};\n\napp.initializers.add('jamesinc/send-dm', () => {\n\textend(CommentPost.prototype, 'actionItems', function (items) {\n\t\tconst post = this.attrs.post;\n\t\tconst user = post.user()\n\n\t\tif (!canStartPrivateDiscussion(user) || post.data.attributes.isHidden) return;\n\n\t\titems.add(\n\t\t\t\"private-discussion\",\n\t\t\tButton.component({\n\t\t\t\tclassName: \"Button Button--link Button--sendPrivateMessage\",\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tlet recipients = new ItemList();\n\t\t\t\t\t\tlet privateDiscussionComposer = require(\"@fof-byobu\").discussions.PrivateDiscussionComposer;\n\n\t\t\t\t\t\trecipients.add(\"users:\" + app.session.user.id(), app.session.user);\n\t\t\t\t\t\trecipients.add(\"users:\" + user.id(), user)\n\n\t\t\t\t\t\tprivateDiscussionComposer.prototype.recipients = recipients;\n\n\t\t\t\t\t\tapp.composer.load(privateDiscussionComposer, {\n\t\t\t\t\t\t\tuser: app.session.user,\n\t\t\t\t\t\t\trecipients: recipients,\n\t\t\t\t\t\t\trecipientUsers: recipients,\n\t\t\t\t\t\t\ttitlePlaceholder: app.translator.trans(\"fof-byobu.forum.composer_private_discussion_title_placeholder\"),\n\t\t\t\t\t\t\tsubmitLabel: app.translator.trans(\"fof-byobu.forum.composer_private_discussion.submit_button\")\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tapp.composer.show();\n\t\t\t\t\t\treturn resolve(app.composer);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t\tapp.translator.trans(\"fof-byobu.forum.buttons.send_pd\", { username: user.displayName() }))\n\t\t);\n\t});\n});\n"],"names":["module","exports","flarum","extensions","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","core","compat","app","add","extend","CommentPost","items","recipient","post","this","attrs","user","id","attribute","blocksPd","data","attributes","isHidden","Button","className","onclick","e","preventDefault","Promise","resolve","recipients","ItemList","privateDiscussionComposer","require","PrivateDiscussionComposer","load","recipientUsers","titlePlaceholder","trans","submitLabel","show","username","displayName"],"sourceRoot":""}